# Notas diárias - 2026-02-28

Resumo da sessão: implementação e recuperação do Mission Control (Next.js) no servidor odanielsoares.tech. Substituí o repo anterior pelo projeto `crshdn/mission-control` e depois pelo `crshdn` -> reescrdn; várias iterações com nginx, PM2, bridge WebSocket e limpeza de caches do cliente. A prioridade foi tirar do ar UI indevida (/chat) e garantir que o Mission Control correto esteja servindo com /ws conectado ao OpenClaw Gateway.

Principais eventos do dia:
- Deploy e testes do frontend Mission Control (Next.js) a partir de repositório externo (crshdn/mission-control). Build concluído.
- Configuração e reconfiguração do Nginx: proxy / → 127.0.0.1:3000; /ws → 127.0.0.1:4000; map $http_upgrade corrigido; rotas sensíveis (/chat, /sessions) bloqueadas temporariamente.
- PM2 usado para gerenciar processos: mission-control (Next), gateway-bridge (Python bridge), remoção de processos mock (arnaldo, ws-tls-proxy).
- Criada rota /clear-client para forçar service worker unregister + clear session/localStorage nos clientes.
- Várias reconfigurações, reinícios e limpeza de processos para resolver conflitos e caches antigos.
- Situação de segurança: bloqueio temporário por firewall (iptables/ip6tables) foi usado para proteger o domínio enquanto implantávamos; depois removido quando pronto.

Status atual (fim do dia):
- mission-control (PM2) → online
- gateway-bridge (PM2) → online
- nginx → rodando com config final; /chat e /sessions bloqueados por 403
- Observado: instabilidade intermitente de upstream (nginx logs mostram connect() failed / upstream prematurely closed) durante redeploys; já em mitigação.

Pendências de follow-up:
- Confirmar estabilidade 100% (logs sem connect() failed por 10–15min) antes de limpeza final e remoção de helpers (clear-client, fallback proxies)
- Verificar asset 404s / limpar caches / service workers em clientes de teste
- Revisar política de autenticação e seeds de usuários (token local gerado e seed demo criado) para ambiente de produção

Logs principais salvos:
- /var/log/nginx/access.log
- /var/log/nginx/error.log
- /root/.pm2/logs/mission-control-*.log
- /root/.pm2/logs/gateway-bridge-*.log
- /tmp/site_out.html (snapshot)

Feito por: Amora (agent)

---
